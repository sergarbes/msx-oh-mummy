10 SCREEN 1:WIDTH 32
30 DIM LB$(14)
35 DIM LA$(18,15)

40 DEF FN PE (X,Y,C) = VPEEK(6144+X+Y*32) = C

100 RESTORE 10000
180 FOR I = 0 TO 14
190     READ L$
200     LB$(I) = L$
210 NEXT I

220 FOR I = 0 TO 14
230     PRINT LB$(I)
240 NEXT I

250 X = 1
260 Y = 7

270 LOCATE X,Y:PRINT CHR$(191)

275 GOSUB 390

1 ' BUCLE DEL JUEGO
280 ST = STICK(0)

285 GOSUB 800: GOSUB 950: GOSUB 1000: GOSUB 1070: GOSUB 1300

290 ' Mover hacia arriba si no hay muro y no está en la fila superior
300 IF ST = 1 AND Y > 0 AND MID$(LB$(Y - 1), X+1, 1) <> "*" THEN Y = Y - 1:LOCATE X, Y+1: PRINT CHR$(98):LOCATE X, Y: PRINT CHR$(191)

310 ' Mover hacia la derecha si no hay muro y no está en la columna más a la derecha
320 IF ST = 3 AND X < 18 AND MID$(LB$(Y), X+2, 1) <> "*" THEN X = X + 1:LOCATE X-1, Y: PRINT CHR$(98):LOCATE X, Y: PRINT CHR$(191)

330 ' Mover hacia abajo si no hay muro y no está en la fila inferior
340 IF ST = 5 AND Y < 18 AND MID$(LB$(Y + 1), X+1, 1) <> "*" THEN Y = Y + 1:LOCATE X, Y-1: PRINT CHR$(98):LOCATE X, Y: PRINT CHR$(191)

350 ' Mover hacia la izquierda si no hay muro y no está en la columna más a la izquierda
360 IF ST = 7 AND X > 0 AND MID$(LB$(Y), X, 1) <> "*" THEN X = X - 1:LOCATE X+1, Y: PRINT CHR$(98):LOCATE X, Y: PRINT CHR$(191)

380 GOTO 280


1 ' SUBRUTINAS


1 ' redefinimos con otra apariencia los caracteres de los muros y personaje
390 RESTORE 11000

1 ' 42 ASCII *
391 FOR R=0 TO 7:READ C$:VPOKE 42*8+R,(VAL("&B"+C$)):NEXT:'VPOKE 8197,12*16+9
393 VPOKE 8197,8*16+14 ' color del muro

395 FOR R=0 TO 7:READ H$:VPOKE 191*8+R,(VAL("&B"+H$)):NEXT
396 VPOKE 8215,10*16+0: ' color del prota

1 ' 97 ASCII a
398 FOR R=0 TO 7:READ H$:VPOKE 97*8+R,(VAL("&B"+H$)):NEXT
399 VPOKE 8204,14*16+0: ' color bloques interior

400 RETURN


1 ' SUBRUTINA DESCUBRE TUMBAS ESQUINA SUPERIOR IZQUIERDA
800 IF VPEEK(6144+(X+1)+(Y+1)*32) = 97 AND VPEEK(6144+(X+2)+(Y+1)*32) = 97 THEN 815 ELSE 900

1 ' MIRAMOS SI LAS OTRAS 11 POSICIONES ESTAN PISADAS
815 IF VPEEK(6144+(X+1)+Y*32) = 98 AND VPEEK(6144+(X+2)+Y*32) = 98 AND VPEEK(6144+(X+3)+Y*32) = 98 THEN 820 ELSE 900

820 IF VPEEK(6144+(X+3)+(Y+1)*32) = 98 AND VPEEK(6144+(X+3)+(Y+2)*32) = 98 AND VPEEK(6144+(X+3)+(Y+3)*32) = 98 THEN 825 ELSE 900

825 IF VPEEK(6144+(X+2)+(Y+3)*32) = 98 AND VPEEK(6144+(X+1)+(Y+3)*32) = 98 AND VPEEK(6144+X+(Y+3)*32) = 98 THEN 830 ELSE 900

830 IF VPEEK(6144+X+(Y+2)*32) = 98 AND VPEEK(6144+X+(Y+1)*32) = 98 THEN 835 ELSE 900

1' DESCUBRE LA TUMBA
835 VPOKE 6144+(X+1)+(Y+1)*32,42: VPOKE 6144+(X+2)+(Y+1)*32,42 : VPOKE 6144+(X+1)+(Y+2)*32,42 : VPOKE 6144+(X+2)+(Y+2)*32,42

900 RETURN


1 ' SUBRUTINA DESCUBRE TUMBAS ESQUINA INFERIOR IZQUIEDA
950 IF VPEEK(6144+(X+1)+(Y-1)*32) = 97 AND VPEEK(6144+(X+2)+(Y-1)*32) = 97 THEN 955 ELSE 990

1 ' MIRAMOS SI LAS OTRAS 11 POSICIONES ESTAN PISADAS
955 IF VPEEK(6144+X+(Y-1)*32) = 98 AND VPEEK(6144+X+(Y-2)*32) = 98 AND VPEEK(6144+X+(Y-3)*32) = 98 THEN 960 ELSE 990

960 IF VPEEK(6144+(X+1)+(Y-3)*32) = 98 AND VPEEK(6144+(X+1)+(Y-3)*32) = 98 AND VPEEK(6144+(X+3)+(Y-3)*32) = 98 THEN 965 ELSE 990

965 IF VPEEK(6144+(X+3)+(Y-2)*32) = 98 AND VPEEK(6144+(X+3)+(Y-1)*32) = 98 AND VPEEK(6144+(X+3)+Y*32) = 98 THEN 970 ELSE 990

970 IF VPEEK(6144+(X+2)+Y*32) = 98 AND VPEEK(6144+(X+1)+Y*32) = 98 THEN 980 ELSE 990

1' DESCUBRE LA TUMBA
980 VPOKE 6144+(X+1)+(Y-1)*32,42: VPOKE 6144+(X+1)+(Y-2)*32,42 : VPOKE 6144+(X+2)+(Y-1)*32,42 : VPOKE 6144+(X+2)+(Y-2)*32,42

990 RETURN


1 ' SUBRUTINA DESCUBRE TUMBAS ESQUINA SUPERIOR DERECHA
1000 IF VPEEK(6144+(X-1)+(Y+1)*32) = 97 AND VPEEK(6144+(X-1)+(Y+2)*32) = 97 THEN 1010 ELSE 1060

1 ' MIRAMOS SI LAS OTRAS 11 POSICIONES ESTAN PISADAS
1010 IF VPEEK(6144+X+(Y+1)*32) = 98 AND VPEEK(6144+X+(Y+2)*32) = 98 AND VPEEK(6144+X+(Y+3)*32) = 98 THEN 1020 ELSE 1060

1020 IF VPEEK(6144+(X-1)+(Y+3)*32) = 98 AND VPEEK(6144+(X-2)+(Y+3)*32) = 98 AND VPEEK(6144+(X-3)+(Y+3)*32) = 98 THEN 1030 ELSE 1060

1030 IF VPEEK(6144+(X-3)+(Y+2)*32) = 98 AND VPEEK(6144+(X-3)+(Y+1)*32) = 98 AND VPEEK(6144+(X-3)+Y*32) = 98 THEN 1040 ELSE 1060

1040 IF VPEEK(6144+(X-2)+Y*32) = 98 AND VPEEK(6144+(X-1)+Y*32) = 98 THEN 1050 ELSE 1060

1' DESCUBRE LA TUMBA
1050 VPOKE 6144+(X-1)+(Y+1)*32,42: VPOKE 6144+(X-2)+(Y+1)*32,42 : VPOKE 6144+(X-1)+(Y+2)*32,42 : VPOKE 6144+(X-2)+(Y+2)*32,42

1060 RETURN


1 ' SUBRUTINA DESCUBRE TUMBAS ESQUINA INFERIOR DERECHA
1070 IF VPEEK(6144+(X-1)+(Y-1)*32) = 97 AND VPEEK(6144+(X-2)+(Y-1)*32) = 97 THEN 1080 ELSE 1130

1 ' MIRAMOS SI LAS OTRAS 11 POSICIONES ESTAN PISADAS
1080 IF VPEEK(6144+(X-1)+Y*32) = 98 AND VPEEK(6144+(X-2)+Y*32) = 98 AND VPEEK(6144+(X-3)+Y*32) = 98 THEN 1090 ELSE 1130

1090 IF VPEEK(6144+(X-3)+(Y-1)*32) = 98 AND VPEEK(6144+(X-3)+(Y-2)*32) = 98 AND VPEEK(6144+(X-3)+(Y-3)*32) = 98 THEN 1100 ELSE 1130

1100 IF VPEEK(6144+(X-2)+(Y-3)*32) = 98 AND VPEEK(6144+(X-1)+(Y-3)*32) = 98 AND VPEEK(6144+X+(Y-3)*32) = 98 THEN 1110 ELSE 1130

1110 IF VPEEK(6144+X+(Y-2)*32) = 98 AND VPEEK(6144+X+(Y-1)*32) = 98 THEN 1120 ELSE 1130

1' DESCUBRE LA TUMBA
1120 VPOKE 6144+(X-1)+(Y-1)*32,42: VPOKE 6144+(X-2)+(Y-1)*32,42 : VPOKE 6144+(X-1)+(Y-2)*32,42 : VPOKE 6144+(X-2)+(Y-2)*32,42

1130 RETURN


1 ' IMPRESION DE LO QUE VE EL PERSONAJE DELANTE
1300 LOCATE 19,10 : PRINT X
1310 LOCATE 22,10 : PRINT Y
1320 LOCATE 25,10 : PRINT VPEEK(6144+(X+1)+Y*32)
1390 RETURN



1 ' DATA


10000 DATA "******************"
10010 DATA "*                *"
10020 DATA "* aa aa aa aa aa *"
10030 DATA "* aa aa aa aa aa *"
10040 DATA "*                *"
10050 DATA "* aa aa aa aa aa *"
10060 DATA "* aa aa aa aa aa *"
10070 DATA "*                *"
10080 DATA "* aa aa aa aa aa *"
10090 DATA "* aa aa aa aa aa *"
10100 DATA "*                *"
10110 DATA "* aa aa aa aa aa *"
10120 DATA "* aa aa aa aa aa *"
10130 DATA "*                *"
10140 DATA "******************"

1 ' muro
11000 DATA "11101110"
11010 DATA "11101110"
11020 DATA "00000000"
11030 DATA "10111011"
11040 DATA "10111011"
11050 DATA "10111011"
11060 DATA "00000000"
11070 DATA "11101110"

1 ' prota
11080 DATA "10100101"
11090 DATA "01111110"
11100 DATA "10011001"
11110 DATA "10011001"
11120 DATA "11111111"
11130 DATA "11000011"
11140 DATA "01100110"
11150 DATA "00111100"

1 ' bloque interior
11160 DATA "01111110"
11170 DATA "11111111"
11180 DATA "11111111"
11190 DATA "11110111"
11200 DATA "11101011"
11210 DATA "11010101"
11220 DATA "11111011"
11230 DATA "01111110"
